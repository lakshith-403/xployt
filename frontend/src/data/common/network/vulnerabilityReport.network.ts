import NETWORK, { Response } from "@data/network/network";

export class VulnerabilityReportEndpoints{
    private static  readonly BASE_URL = '/api/reports/vulnerability';

    static async getReportById(reportId: string): Promise<Response>{
        return NETWORK.sendHttpRequest('GET', `${this.BASE_URL}/${reportId}`);
    }

    static async createReport(report: any, attachments: File[]): Promise<Response>{
        const formData = new FormData();
        formData.append('report', JSON.stringify(report));
        attachments.forEach((attachment: any) => {
            formData.append('files', attachment);
        });

        console.log(formData);

        return NETWORK.sendHttpRequest('POST', `${this.BASE_URL}`, formData, 'multipart/form-data');
    }

    static async updateReport(report:any, attachments: File[]): Promise<Response>{
        console.log('updateReport', report);
        const formData = new FormData();
        formData.append('report', JSON.stringify(report));
        attachments.forEach((attachment: any) => {
            formData.append('files', attachment);
        });

        return NETWORK.sendHttpRequest('POST', `${this.BASE_URL}/edit`, formData, 'multipart/form-data');
    }
}